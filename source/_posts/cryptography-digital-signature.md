---
title: cryptography-digital-signature
date: 2020-04-13 17:57:47
tags:
---
### Digital signature characteristics
- Unforgeable (위조불가)
    - 서명자만이 서명문을 생성 가능
- Authentic (서명자 인증)
    - 서명문의 서명자를 확인 가능
- Not Reusable (재사용 불가)
    - 서명문의 서명은 다른 문서의 서명으로 사용 불가능
- Unalterable (변경 불가)
    - 서명된 문서의 내용 변경 불가능
- Nonrepudiation (부인 불가)
    - 서명자는 후에 서명한 사실을 부인 불가능

### Digital signature Requirement
- 서명은 메세지에 의존하는 비트 형태이어야 한다.
- 위조와 부인 방지 위해, 송신자의 유일한 정보 비트를 이용해야 함
- 서명문을 만들기가 쉬워야 한다.
- 서명문을 인식, 확인 하기가 쉬워야 한다.
- 서명문을 위조하는 것이 계산적으로 실행 불가능
- 기억장소에 서명문의 복사본을 유지하는 것이 실용적이어야 한다.

#### 메시지에 직접 서명하는 방법
![](/images/cryptography/message_signature/message_signature.png)

#### 메세지의 해시 값에 서명하는 방법
![](/images/cryptography/message_signature/hash_signature.png)
![](/images/cryptography/message_signature/hash_time_flow.png)


#### 디지털 서명에 대한 의문
1. 암호문이 왜 서명으로서 사용 가능한 것인가?
    - 개인 키로 암호화 한다는 것은, 행하고 있는 처리의 내용을 설명한 것이지, 여기에서는 기밀성을 실현하기 위해 암호화 하는 것이 아니다
    - 인증자 (authenticator) : 키를 가지고 있는 사람만이 만들 수 있는 정보

2. 기밀성을 유지할 수 없는 것은 아닐까?
    - 디지털 서명은 기밀성을 지키기 위한 것은 아님
    - 기밀성이 필요하다면 암호화를 별도로 행해서 보내야 한다.
    
3. 복사된 서명이 만들어지는 것은 아닐까?
    - 통상의 파일 복사처럼 서명도 복사본을 만들수 있다.
    - 서명 복사를 만들 수 있다고 해서 서명이 무의미 해 지는 것은 아니다.
        - 복사한 데이터가 표현하고 있는 것은 특정의 서명자가 특정의 메세지에 서명했다고 하는 것뿐
        - 복사해도 서명자는 바뀌지 않고 메세지의 내용도 바뀌지 않는다.
    - 복사된 서명
        - 특정 서명자와 특정 메세지가 결부되어 있다는 사실이 중요
        - 아무리 복사를 해도 그 메세지에 누가 서명했는가는 사실에는 변화가 없다.

4.  서명 변경이 가능한 것은 아닐까?
    - 서명 후 메세지와 서명의 내용을 수정할 수는 있다.
    - 수정하면 서명 검증에 실패하기 때문에, 검증하는 사람은 수정이 행해졌다는 것을 검출 할 수 있다.
    - 서명 대상의 메세지와 서명 양쪽을 수정해서 서명의 검증에 성공할 수 있도록 앞뒤를 잘 맞출 수 있지는 않을까?
        - 불가능

5. 서명만 재이용할 수 있는 것은 아닐까?
    - 서명부분만 잘라내서 다른 메세지에 첨부하는 것은 가능하나 서명의 검증에는 실패

6. 서명을 삭제하더라도 계약파기를 할 수 없는 것은 아닌가?
    - 디지털 서명이 붙은 차용서는 삭제해도 파기 할 수 없다.
    - 디지털 서명이 붙은 차용서를 파기하는 경우에는 영수증에 상당하는 문서를 새로 만들고, 그것에 대해 상대에게 서명을 부탁해야 한다.  
    
7. 어떻게 해서 부인 방지가 되는 것인가?
    - 디지털 서명의 경우 서명을 작성할 수 있는 키(개인 키)는 송신자마ㄴ 가지고 있다. 그러므로 서명을 작성할 수 있는 것은 송신자 뿐
    - 그 서명을 내가 작성한 것이 아니다 라고 주장 할 수 없다.
    
### 활용 예
1. 보안 공지
    - 클리어 서명(Clearsign) : 메세지를 암호화하지 않고 서명만 한것
![](/images/cryptography/message_signature/digital_signature_use_case_1.png)    

2. 소프트 웨어 다운로드
    - 소프트웨어에 디지털 서명을 작성하고, 서명 검증

3. 공개 키 인증서
    - 디지털 서명을 검증하려면 바른 공개 키가 필요
    - 자신이 입수한 공개키가 바른 공개 키인지 어떤지를 검증하기 위해서 공개 키를 메세지로 간주하고 디지털 서명을 한다.
    - 공개 키 인증서 : 공개키에 디지털 서명을 붙인 것
    
4. TLS
    - TLS에서는 서버가 올바른 것이라는 것을 인증하기 위해서 서버 인증서를 이용하며 서버의 공개키에 디지털 서명을 한 것.
    
### RSA에 의한 디지털 서명
- 서명(s) = ${m^D mod N}$
- 서명으로 얻어진 메세지(m) = ${s^E mod N}$
- E와 N은 서명자의 공개키 

|||
|-|-|
|공개키|(E,N)|
|개인키|(D,N)|
|서명의 작성|서명(s) = ${m^D mod N}$ (메세지를 D제곱해서 N으로 나눈 나머지)|
|서명의 검증|서명으로 얻어진 메세지(m) = ${s^E mod N}$ (m과 원래 메세지 비교)|


#### 디지털 서명에 대한 공격
1. 중간자 공격
    - 입수한 공개 키가 정확한 상대의 것인지 아닌지를 확인하는 것이 필요
    - 공개 키를 취급하는 소프트웨어는 공개 키의 해시 값을 표시하는 수단을 준비 (fingerprint)

2. 일방향 해시 함수 공격
    - 일방향 해시 함수는 충돌 내성을 가져야 한다.

3. 디지털 서명을 사용한 공개 키 암호 공격
    - 모르는 메세지에는 서명을 하지 말자.
    
 #### 기술적인 방법만으로는 해결할 수 없는 문제
 ![](/images/cryptography/message_signature/problem.png)    
